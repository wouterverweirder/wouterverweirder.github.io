{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2011/12/10/udp-in-air-for-ios-using-a-native-extension/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://blog.aboutme.be"}},"markdownRemark":{"id":"00b3b5bb-62ac-5735-b0e5-37feff0c11e9","excerpt":"update: added Android support to the extension. When you’re using a mobile device as a controller for an application or a game, you’ll want fast data transfers…","html":"<p><strong>update: <a href=\"/2011/12/14/udp-native-extension-for-air-mobile-now-with-android-support/\">added Android support to the extension</a>.</strong></p>\n<p>When you’re using a mobile device as a controller for an application or a game, you’ll want fast data transfers. Classic TCP/IP traffic over sockets is a bit slow, due to the nature of TCP/IP (packets are delivered in the correct order, the receiver sends a confirmation of reception to the sender for each received packet). The alternative is UDP: you’re not sure if the packet arrives, or in what order you packets will arrive at the destination, but because of that, there is less delay between the sender and the receiver of the packet.</p>\n<p>AIR has a builtin class to handle UDP: flash.net.DatagramSocket. However, for some reason this is not available on AIR for mobile devices. I decided to write a native extension (<del datetime=\"2011-12-14T19:59:22+00:00\">only for iOS for now</del>) to offer UDP functionality on AIR for mobile devices. I tried to use the same API as the DatagramSocket for AIR for Desktop, so the principles are the same.</p>\n<p><img src=\"/wp-content/uploads/2011/12/screenshot_0.1.png\" alt=\"Example of UDPSocket extension on AIR for iOS\" title=\"Example of UDPSocket extension on AIR for iOS\"></p>\n<p>To send packets over UDP, you’ll create an instance of the UDPSocket class (be.aboutme.nativeExtensions.udp.UDPSocket), and use the send method with a bytearray:</p>\n<div class=\"gatsby-highlight\" data-language=\"actionscript\"><pre class=\"language-actionscript\"><code class=\"language-actionscript\"><span class=\"token keyword\">var</span> udpSocket<span class=\"token punctuation\">:</span>UDPSocket <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UDPSocket</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> bytes<span class=\"token punctuation\">:</span>ByteArray <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ByteArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbytes<span class=\"token punctuation\">.</span><span class=\"token function\">writeUTFBytes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello World\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nudpSocket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">,</span> <span class=\"token string\">\"192.168.9.1\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1234</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>To receive packets, you’ll use the bind(portnr) and receive() methods of the same class, and listen to a DatagramSocketEvent.DATA event:</p>\n<div class=\"gatsby-highlight\" data-language=\"actionscript\"><pre class=\"language-actionscript\"><code class=\"language-actionscript\"><span class=\"token keyword\">var</span> udpSocket<span class=\"token punctuation\">:</span>UDPSocket <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UDPSocket</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nudpSocket<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span>DatagramSocketDataEvent<span class=\"token punctuation\">.</span><span class=\"token constant\">DATA</span><span class=\"token punctuation\">,</span> udpDataHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">udpSocket</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nudpSocket<span class=\"token punctuation\">.</span><span class=\"token function\">receive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function\">udpDataHandler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">:</span>DatagramSocketDataEvent</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">void</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token function\">trace</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>It will transfer whatever you put in the bytearray, so you can send native actionscript objects aswell if you want:</p>\n<div class=\"gatsby-highlight\" data-language=\"actionscript\"><pre class=\"language-actionscript\"><code class=\"language-actionscript\"><span class=\"token keyword\">var</span> bytes<span class=\"token punctuation\">:</span>ByteArray <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ByteArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> o<span class=\"token punctuation\">:</span>Object <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\no<span class=\"token punctuation\">.</span>command <span class=\"token operator\">=</span> <span class=\"token string\">\"MESSAGE\"</span><span class=\"token punctuation\">;</span>\no<span class=\"token punctuation\">.</span>content <span class=\"token operator\">=</span> <span class=\"token string\">\"Hello World!\"</span><span class=\"token punctuation\">;</span>\nbytes<span class=\"token punctuation\">.</span><span class=\"token function\">writeObject</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nudpSocket<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">,</span> <span class=\"token string\">\"192.168.9.1\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1234</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>You can find the ane, together with the sources &#x26; demo on github: <a href=\"https://github.com/wouterverweirder/AIR-Mobile-UDP-Extension\" title=\"Source on Github\">https://github.com/wouterverweirder/AIR-Mobile-UDP-Extension</a>. The native extension id is “be.aboutme.nativeExtensions.udp.UDPSocket”. <del datetime=\"2011-12-14T19:59:22+00:00\">Stay tuned for the Android version</del> The extension has been updated, and supports Android aswell now!</p>","fields":{"slug":"/2011/12/10/udp-in-air-for-ios-using-a-native-extension/"},"frontmatter":{"title":"UDP in AIR for iOS using a native extension","date":"10 Dec, 2011","description":false,"tags":["AIR","iOS","native extensions"],"hasCover":false,"cover":{"publicURL":"/static/38bf334212404fb8f25838f80898b83a/preview.png","childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='62'%20height='62'%20viewBox='0%200%2062%2062'%20preserveAspectRatio='none'/%3e","aspectRatio":0.7493606138107417,"src":"/static/38bf334212404fb8f25838f80898b83a/21b0e/preview.png","srcSet":"/static/38bf334212404fb8f25838f80898b83a/12aff/preview.png 293w,\n/static/38bf334212404fb8f25838f80898b83a/8dd70/preview.png 585w,\n/static/38bf334212404fb8f25838f80898b83a/21b0e/preview.png 690w","srcWebp":"/static/38bf334212404fb8f25838f80898b83a/f3dc3/preview.webp","srcSetWebp":"/static/38bf334212404fb8f25838f80898b83a/05ceb/preview.webp 293w,\n/static/38bf334212404fb8f25838f80898b83a/5c538/preview.webp 585w,\n/static/38bf334212404fb8f25838f80898b83a/f3dc3/preview.webp 690w","sizes":"(max-width: 690px) 100vw, 690px"}}}}},"allMarkdownRemark":{"edges":[{"node":{"fields":{"slug":"/2012/02/29/fitc-amsterdam-slides-demo-videos-of-opencv-finger-tracking-air-native-extensions/"},"frontmatter":{"title":"FITC Amsterdam – slides & demo videos of opencv & finger tracking air native extensions","tags":["AIR","air native extension","airkinect","finger tracking","fitc","fitc amsterdam 2012","opencv"],"cover":{"publicURL":"/static/38bf334212404fb8f25838f80898b83a/preview.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAAFklEQVQoz2P4T2XAMGrgqIGjBg6EgQDPpbxuORFYHwAAAABJRU5ErkJggg==","aspectRatio":1.6901408450704225,"src":"/static/38bf334212404fb8f25838f80898b83a/c0ead/preview.png","srcSet":"/static/38bf334212404fb8f25838f80898b83a/3ddd7/preview.png 120w,\n/static/38bf334212404fb8f25838f80898b83a/bab64/preview.png 240w,\n/static/38bf334212404fb8f25838f80898b83a/c0ead/preview.png 480w,\n/static/38bf334212404fb8f25838f80898b83a/608b8/preview.png 690w","srcWebp":"/static/38bf334212404fb8f25838f80898b83a/1f47d/preview.webp","srcSetWebp":"/static/38bf334212404fb8f25838f80898b83a/504a6/preview.webp 120w,\n/static/38bf334212404fb8f25838f80898b83a/36764/preview.webp 240w,\n/static/38bf334212404fb8f25838f80898b83a/1f47d/preview.webp 480w,\n/static/38bf334212404fb8f25838f80898b83a/26a56/preview.webp 690w","sizes":"(max-width: 480px) 100vw, 480px"}}}}}},{"node":{"fields":{"slug":"/2012/01/13/access-the-mac-sudden-motion-sensor-with-an-air-native-extension/"},"frontmatter":{"title":"Access the mac sudden motion sensor with an AIR native extension","tags":["accelerometer","AIR","native extension","OSX","sudden motion sensor"],"cover":{"publicURL":"/static/38bf334212404fb8f25838f80898b83a/preview.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAAFklEQVQoz2P4T2XAMGrgqIGjBg6EgQDPpbxuORFYHwAAAABJRU5ErkJggg==","aspectRatio":1.6901408450704225,"src":"/static/38bf334212404fb8f25838f80898b83a/c0ead/preview.png","srcSet":"/static/38bf334212404fb8f25838f80898b83a/3ddd7/preview.png 120w,\n/static/38bf334212404fb8f25838f80898b83a/bab64/preview.png 240w,\n/static/38bf334212404fb8f25838f80898b83a/c0ead/preview.png 480w,\n/static/38bf334212404fb8f25838f80898b83a/608b8/preview.png 690w","srcWebp":"/static/38bf334212404fb8f25838f80898b83a/1f47d/preview.webp","srcSetWebp":"/static/38bf334212404fb8f25838f80898b83a/504a6/preview.webp 120w,\n/static/38bf334212404fb8f25838f80898b83a/36764/preview.webp 240w,\n/static/38bf334212404fb8f25838f80898b83a/1f47d/preview.webp 480w,\n/static/38bf334212404fb8f25838f80898b83a/26a56/preview.webp 690w","sizes":"(max-width: 480px) 100vw, 480px"}}}}}},{"node":{"fields":{"slug":"/2012/01/07/accessing-the-kinect-in-javascript-through-websockets/"},"frontmatter":{"title":"Accessing the kinect in javascript through websockets","tags":["AIR","airkinect","AIRServer","as3nui","canvas","html5","js","kinect","threejs"],"cover":{"publicURL":"/static/38bf334212404fb8f25838f80898b83a/preview.png","childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAAFklEQVQoz2P4T2XAMGrgqIGjBg6EgQDPpbxuORFYHwAAAABJRU5ErkJggg==","aspectRatio":1.6901408450704225,"src":"/static/38bf334212404fb8f25838f80898b83a/c0ead/preview.png","srcSet":"/static/38bf334212404fb8f25838f80898b83a/3ddd7/preview.png 120w,\n/static/38bf334212404fb8f25838f80898b83a/bab64/preview.png 240w,\n/static/38bf334212404fb8f25838f80898b83a/c0ead/preview.png 480w,\n/static/38bf334212404fb8f25838f80898b83a/608b8/preview.png 690w","srcWebp":"/static/38bf334212404fb8f25838f80898b83a/1f47d/preview.webp","srcSetWebp":"/static/38bf334212404fb8f25838f80898b83a/504a6/preview.webp 120w,\n/static/38bf334212404fb8f25838f80898b83a/36764/preview.webp 240w,\n/static/38bf334212404fb8f25838f80898b83a/1f47d/preview.webp 480w,\n/static/38bf334212404fb8f25838f80898b83a/26a56/preview.webp 690w","sizes":"(max-width: 480px) 100vw, 480px"}}}}}}]}},"pageContext":{"slug":"/2011/12/10/udp-in-air-for-ios-using-a-native-extension/","previous":{"fields":{"slug":"/2011/12/03/including-dylib-in-air-native-extension-for-osx/"},"frontmatter":{"title":"including dylib in air native extension for OSX","tags":["AIR","native extensions","OSX"]}},"next":{"fields":{"slug":"/2011/12/14/udp-native-extension-for-air-mobile-now-with-android-support/"},"frontmatter":{"title":"UDP Native Extension for AIR Mobile – now with Android Support!","tags":["AIR","android","iOS","native extensions"]}},"tag":["AIR","iOS","native extensions"]}}}