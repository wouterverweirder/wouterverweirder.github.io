{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2012/03/27/opencv-air-native-extension/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://blog.aboutme.be"}},"markdownRemark":{"id":"970e6afb-de2f-5613-be54-b7dff2e05b3b","excerpt":"In preparation of my FITC session last month, I wrote a native extension to integrate OpenCV in your AIR applications. What it does is use OpenCV in a…","html":"<p>In preparation of my FITC session last month, I wrote a native extension to integrate OpenCV in your AIR applications. What it does is use OpenCV in a multithreaded extension, to execute HAAR cascades against a bitmap you provide from ActionScript. This bitmap could be a snapshot of your webcam image, but could also be data from other sources (e.g. kinect camera snapshot?).</p>\n<p>I had quite a hard time to get OpenCV compiling &#x26; integrating it on my device, and I don’t know if it’ll work on other people’s computers. It only works on OSX, my system was OSX 10.7 (Lion). After a lot of trying, I managed to compile opencv as static libraries, and could integrate them in a native extension package.</p>\n<p>The extension ID is be.aboutme.nativeExtensions.opencv.OpenCV. It’s event based, and will execute the heavy haar detection code in a seperate thread, so your actionscript project doesn’t lock up. First of all, you’ll create an instance of the extension, add a detection listener and load a haar cascade xml file:</p>\n<div class=\"gatsby-highlight\" data-language=\"actionscript\"><pre class=\"language-actionscript\"><code class=\"language-actionscript\">openCV <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OpenCV</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nopenCV<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span>DetectionEvent<span class=\"token punctuation\">.</span><span class=\"token constant\">DETECTION_UPDATE</span><span class=\"token punctuation\">,</span> detectionUpdateHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nopenCV<span class=\"token punctuation\">.</span><span class=\"token function\">loadCascade</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/Users/wouter/haarcascades/haarcascade_frontalface_alt2.xml\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>You will also need to send bitmap data to the extension. In this example, I’m sending a bitmap snapshot of the webcam image to the extension, using the updateImage method. You can also set minimum &#x26; maximum sizes for the detection area’s, so area’s smaller then the mnimum size of larger then the maximum size are ignored. I recommend supplying a minimum size for the detection (for example: face must be at least 40×40 pixels), as this will improve performance of the application:</p>\n<div class=\"gatsby-highlight\" data-language=\"actionscript\"><pre class=\"language-actionscript\"><code class=\"language-actionscript\">bmpData<span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>video<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nopenCV<span class=\"token punctuation\">.</span><span class=\"token function\">updateImage</span><span class=\"token punctuation\">(</span>bmpData<span class=\"token punctuation\">,</span> minSize<span class=\"token punctuation\">,</span> maxSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>In the event handler, you’ll get the detected area’s with the event object that is provided:</p>\n<div class=\"gatsby-highlight\" data-language=\"actionscript\"><pre class=\"language-actionscript\"><code class=\"language-actionscript\"><span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function\">detectionUpdateHandler</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">:</span>DetectionEvent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">void</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token keyword\">each</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> r<span class=\"token punctuation\">:</span>Rectangle <span class=\"token keyword\">in</span> event<span class=\"token punctuation\">.</span>rectangles<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//draw rectangles here</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>I’ve commited everything (native, as3 code &#x26; demo) to a github repo (<a href=\"https://github.com/wouterverweirder/AIR-OpenCV-Extension\" title=\"Code on Github\">https://github.com/wouterverweirder/AIR-OpenCV-Extension</a>)</p>\n<p>Again, it’s a mac-only extension, and will need more testing if my opencv compile will run on other mac’s :-)</p>","fields":{"slug":"/2012/03/27/opencv-air-native-extension/"},"frontmatter":{"title":"OpenCV AIR Native Extension","date":"27 Mar, 2012","description":false,"tags":["air native extension","opencv"],"cover":{"publicURL":"/static/805602bed61cf53a7045318689e7a0b2/preview.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAECAwUE/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAd4z+yW0rLJqQIYf/8QAGhAAAwADAQAAAAAAAAAAAAAAAQIDEBESIP/aAAgBAQABBQLNLMKMdBG6X1//xAAWEQEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQMBAT8BSY//xAAVEQEBAAAAAAAAAAAAAAAAAAARIP/aAAgBAgEBPwFj/8QAGRABAAIDAAAAAAAAAAAAAAAAAQIQESBx/9oACAEBAAY/ArY5OUO//8QAHRABAAICAgMAAAAAAAAAAAAAAQARIUEQIDFxgf/aAAgBAQABPyF5F2Oq21HWrG6GYkT3EJ5n3p//2gAMAwEAAgADAAAAEMzvDP/EABcRAQADAAAAAAAAAAAAAAAAAAERIDH/2gAIAQMBAT8Qjiu0/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAEQESH/2gAIAQIBAT8QDtZP/8QAHxAAAgIBBAMAAAAAAAAAAAAAAREAITEQUWGBcZGh/9oACAEBAAE/EA2nfyJ4XqAdHAipk2eSlLrpgj2LjNIItEXjEMsgPdQgZEEcwAAUnjRDaKf/2Q=="},"images":{"fallback":{"src":"/static/805602bed61cf53a7045318689e7a0b2/3c249/preview.jpg","srcSet":"/static/805602bed61cf53a7045318689e7a0b2/3c249/preview.jpg 690w","sizes":"100vw"},"sources":[{"srcSet":"/static/805602bed61cf53a7045318689e7a0b2/956b7/preview.avif 690w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/805602bed61cf53a7045318689e7a0b2/37026/preview.webp 690w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.3333333333333333}}}}},"allMarkdownRemark":{"edges":[{"node":{"fields":{"slug":"/2012/04/19/air-native-extension-for-simple-speech-recognition-on-osx/"},"frontmatter":{"title":"AIR Native extension for simple speech recognition on OSX","tags":["air native extension","nsspeechrecognizer","OSX","speech recognition"],"cover":{"publicURL":"/static/5d435ebcd0e95724ae62f6a0ad19d846/preview.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAEDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB77Il1qFl0gSP/8QAGRAAAwADAAAAAAAAAAAAAAAAAQIDEBMg/9oACAEBAAEFAstQ7L0KLFiydf/EABcRAQADAAAAAAAAAAAAAAAAAAEAEBH/2gAIAQMBAT8BDY3/AP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EAB0QAAECBwAAAAAAAAAAAAAAAAABQRAREiAhMVH/2gAIAQEABj8CjToRsuTXt/8A/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARECExIFH/2gAIAQEAAT8hyVaD72Igl6LGhC2NSi7oxzx//9oADAMBAAIAAwAAABAL2TD/xAAXEQEBAQEAAAAAAAAAAAAAAAARAQAQ/9oACAEDAQE/EGGgp3//xAAXEQEAAwAAAAAAAAAAAAAAAAABABAR/9oACAECAQE/EFwhf//EAB0QAQADAQACAwAAAAAAAAAAAAEAESExEGFBUfD/2gAIAQEAAT8Qe9h4ww9ucV399Q10oJoC57ay4rUAmlIOczk26H5rYllNMAFAB6lEo8f/2Q=="},"images":{"fallback":{"src":"/static/5d435ebcd0e95724ae62f6a0ad19d846/3c249/preview.jpg","srcSet":"/static/5d435ebcd0e95724ae62f6a0ad19d846/3c249/preview.jpg 690w","sizes":"100vw"},"sources":[{"srcSet":"/static/5d435ebcd0e95724ae62f6a0ad19d846/956b7/preview.avif 690w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/5d435ebcd0e95724ae62f6a0ad19d846/37026/preview.webp 690w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.3333333333333333}}}}}},{"node":{"fields":{"slug":"/2012/02/29/fitc-amsterdam-slides-demo-videos-of-opencv-finger-tracking-air-native-extensions/"},"frontmatter":{"title":"FITC Amsterdam – slides & demo videos of opencv & finger tracking air native extensions","tags":["AIR","air native extension","airkinect","finger tracking","fitc","fitc amsterdam 2012","opencv"],"cover":{"publicURL":"/static/c54a46e8e74c3f7aa8d408c94b6f1640/preview.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAIBAwQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAeytmctHEUaVUkP/xAAZEAADAAMAAAAAAAAAAAAAAAAAARECECD/2gAIAQEAAQUCE69YJ0hBcf/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABgQAAIDAAAAAAAAAAAAAAAAAAABEBEw/9oACAEBAAY/Aipbw//EABwQAAMAAgMBAAAAAAAAAAAAAAABERAhMUGR8P/aAAgBAQABPyGCWInrmohCuO13D379K+YkQs//2gAMAwEAAgADAAAAEB8/vv/EABYRAQEBAAAAAAAAAAAAAAAAABEBIP/aAAgBAwEBPxCBj//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB4QAQACAgEFAAAAAAAAAAAAAAEAESExURBBcaHw/9oACAEBAAE/ECLPHcgXxncYVTWHmEF4B5NV6iRFo0c9sxbcZ+1MNa+W+hjuf//Z"},"images":{"fallback":{"src":"/static/c54a46e8e74c3f7aa8d408c94b6f1640/3c249/preview.jpg","srcSet":"/static/c54a46e8e74c3f7aa8d408c94b6f1640/3c249/preview.jpg 690w","sizes":"100vw"},"sources":[{"srcSet":"/static/c54a46e8e74c3f7aa8d408c94b6f1640/956b7/preview.avif 690w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/c54a46e8e74c3f7aa8d408c94b6f1640/37026/preview.webp 690w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.3333333333333333}}}}}}]}},"pageContext":{"slug":"/2012/03/27/opencv-air-native-extension/","previous":{"fields":{"slug":"/2012/02/29/fitc-amsterdam-slides-demo-videos-of-opencv-finger-tracking-air-native-extensions/"},"frontmatter":{"title":"FITC Amsterdam – slides & demo videos of opencv & finger tracking air native extensions","tags":["AIR","air native extension","airkinect","finger tracking","fitc","fitc amsterdam 2012","opencv"]}},"next":{"fields":{"slug":"/2012/04/19/air-native-extension-for-simple-speech-recognition-on-osx/"},"frontmatter":{"title":"AIR Native extension for simple speech recognition on OSX","tags":["air native extension","nsspeechrecognizer","OSX","speech recognition"]}},"tag":["air native extension","opencv"]}},"staticQueryHashes":["2254173662","63159454"]}