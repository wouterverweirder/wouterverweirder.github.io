{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2017/01/18/detecting-and-killing-processes-in-node-or-electron/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://blog.aboutme.be"}},"markdownRemark":{"id":"21282262-7623-5f04-aebd-c01b913b485f","excerpt":"When building a Kiosk application, you might want to check which processes are running on the system. This way you can try killing unauthorized processes or…","html":"<p>When building a Kiosk application, you might want to check which processes are running on the system. This way you can try killing unauthorized processes or show a warning when an unauthorized process is launched.</p>\n<p><a href=\"https://www.npmjs.com/package/xps\">The nodejs xps package</a> library offers a cross-platform to do most of the work. To make things a little easier, I wrote <a href=\"https://gist.github.com/wouterverweirder/a2f2253279bc2db61d2b5fe8c59b2183\">a little helper class</a> which polls the process list, allows you to specify names of unauthorized processes and dispatch events when a process launches / stops.</p>\n<p>To use this class in your own nodejs or electron apps, make sure to add <a href=\"https://www.npmjs.com/package/xps\">the nodejs xps package</a> to your app. Put <a href=\"https://gist.github.com/wouterverweirder/a2f2253279bc2db61d2b5fe8c59b2183\">my helper class</a> somewhere in your application, and use it’s api:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> processListener <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./process-listener'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> xps <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xps'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> blacklistedProcessNames <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token string\">'System Preferences'</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// do an initial check for blacklisted apps</span>\nprocessListener<span class=\"token punctuation\">.</span><span class=\"token function\">getRunningProcesses</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">processes</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// processes are the initial processes</span>\n  processes<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">process</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isProcessBlacklisted</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Blacklisted process running: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// listen for start &amp; stop of processes</span>\n  processListener<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'start'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">process</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isProcessBlacklisted</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Blacklisted process started: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      xps<span class=\"token punctuation\">.</span><span class=\"token function\">kill</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fork</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Unable to kill process </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Killed process </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  processListener<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'stop'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">process</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isProcessBlacklisted</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Blacklisted process stopped: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  processListener<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// run every x-milliseconds</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","fields":{"slug":"/2017/01/18/detecting-and-killing-processes-in-node-or-electron/"},"frontmatter":{"title":"Detecting and Killing Processes in Node or Electron","date":"18 Jan, 2017","description":false,"tags":["nodejs","electron"],"cover":{"publicURL":"/static/6121545b2c47c05d5e61016ab2b03824/preview.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIEAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABh1t0HmFZRyXmeVjQT//EAB0QAAIBBAMAAAAAAAAAAAAAAAECAAMEEBITIjH/2gAIAQEAAQUCD42i0bbXjtTKi0QytD2YYE8P/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8BKf/EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/ASH/xAAeEAABBAEFAAAAAAAAAAAAAAABAAIQISAiMnKhov/aAAgBAQAGPwK5BL75Lf6Wl3cUcf/EAB0QAAICAwADAAAAAAAAAAAAAAERACEQMVFBYaH/2gAIAQEAAT8hDVEfkruBKAgcMa1yFYBCjxHrhD0EDbg3gSwCf//aAAwDAQACAAMAAAAQ79C9/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEREHH/2gAIAQMBAT8Q7lSMiP/EABgRAAMBAQAAAAAAAAAAAAAAAAABETFR/9oACAECAQE/EE+FRqlP/8QAHRABAAMAAgMBAAAAAAAAAAAAAQARITGBQVFx4f/aAAgBAQABPxBikkrDpFO8H1GrQZDFIwxTW5EgMwVjC/PjnTb+QDXKLqVAQwD5ZTQaNOXGnaeP2JRQv1P/2Q=="},"images":{"fallback":{"src":"/static/6121545b2c47c05d5e61016ab2b03824/3c249/preview.jpg","srcSet":"/static/6121545b2c47c05d5e61016ab2b03824/3c249/preview.jpg 690w","sizes":"100vw"},"sources":[{"srcSet":"/static/6121545b2c47c05d5e61016ab2b03824/956b7/preview.avif 690w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/6121545b2c47c05d5e61016ab2b03824/37026/preview.webp 690w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.3333333333333333}}}}},"allMarkdownRemark":{"edges":[{"node":{"fields":{"slug":"/2021/07/06/making-of-devine-graduation-show-installation/"},"frontmatter":{"title":"Making of devine graduation show installation","tags":["installation","threejs","electron"],"cover":{"publicURL":"/static/0bd2d71755b2e933630308ce108a3fa6/preview.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAECAwQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAfIXgqsg9Nkzi1R//8QAGxAAAgMAAwAAAAAAAAAAAAAAAQIAAxIQERP/2gAIAQEAAQUC2ZszZjjFiL6GMWc1sUPUHP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFREBAQAAAAAAAAAAAAAAAAAAESD/2gAIAQIBAT8BI//EAB0QAAICAQUAAAAAAAAAAAAAAAABETECECAhIkH/2gAIAQEABj8CsssfXjyRwo0nJkrb/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARECExQVH/2gAIAQEAAT8hzsvrGHiAXQTc3tJEYDZW8OiPXH//2gAMAwEAAgADAAAAEHTCjf/EABcRAQEBAQAAAAAAAAAAAAAAAAARIQH/2gAIAQMBAT8Qqu7qP//EABgRAAMBAQAAAAAAAAAAAAAAAAABERBh/9oACAECAQE/EOyDdz//xAAdEAEAAgMAAwEAAAAAAAAAAAABABEhMUFRgZHw/9oACAEBAAE/EAHb4SzQ9BPyCAdqzUq15mFyu8BtyyuDEMVNQ1yKv3YbKY3VqAuo2bhFqMrqUT//2Q=="},"images":{"fallback":{"src":"/static/0bd2d71755b2e933630308ce108a3fa6/3c249/preview.jpg","srcSet":"/static/0bd2d71755b2e933630308ce108a3fa6/3c249/preview.jpg 690w","sizes":"100vw"},"sources":[{"srcSet":"/static/0bd2d71755b2e933630308ce108a3fa6/956b7/preview.avif 690w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/0bd2d71755b2e933630308ce108a3fa6/37026/preview.webp 690w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.3333333333333333}}}}}},{"node":{"fields":{"slug":"/2020/12/15/building-a-laptop-driven-8-screen-installation/"},"frontmatter":{"title":"Building a laptop-driven 8-screen installation","tags":["installation","threejs","electron"],"cover":{"publicURL":"/static/e89fa65512d4b2dee79f452a43b36a99/preview.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgD/2gAMAwEAAhADEAAAAaIqEAwCaVXwdaemYA//xAAcEAACAgIDAAAAAAAAAAAAAAABAgARAxITFDH/2gAIAQEAAQUCOhlqDyJCtuMWWK2OlVlib69aWYHaDz//xAAZEQABBQAAAAAAAAAAAAAAAAAAAQIQEWH/2gAIAQMBAT8BhcKcf//EABgRAQADAQAAAAAAAAAAAAAAAAARIUEi/9oACAECAQE/AZxa8dP/xAAhEAABAwMEAwAAAAAAAAAAAAAAAREhAhAxEiIygVFh4f/aAAgBAQAGPwIWHMEJjMlWlkf2RTX0cn7NkIvk+25Lb//EAB8QAAICAgEFAAAAAAAAAAAAAAABEVEhMXFBYYGR4f/aAAgBAQABPyFsCSrRoRJEHY3c0ICQGwhVTDh1GlogfyCWNKa4+R2MTUKDkyk2/Z//2gAMAwEAAgADAAAAEFDEjf/EABgRAQEBAQEAAAAAAAAAAAAAAAEAESFh/9oACAEDAQE/EBNy5Fntf//EABkRAAMAAwAAAAAAAAAAAAAAAAABETFhcf/aAAgBAgEBPxB24yXYaDo//8QAHBABAAMAAwEBAAAAAAAAAAAAAQARITFBUWFx/9oACAEBAAE/EORFcNNhZzHo8QZksAqlCp8ROYSlT7dlzFWJRKRj3FCNItuZ3l7GYi+prcc1kW2es5fv1BN7fsAADoUKSLR38n//2Q=="},"images":{"fallback":{"src":"/static/e89fa65512d4b2dee79f452a43b36a99/3c249/preview.jpg","srcSet":"/static/e89fa65512d4b2dee79f452a43b36a99/3c249/preview.jpg 690w","sizes":"100vw"},"sources":[{"srcSet":"/static/e89fa65512d4b2dee79f452a43b36a99/956b7/preview.avif 690w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/e89fa65512d4b2dee79f452a43b36a99/37026/preview.webp 690w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.3333333333333333}}}}}},{"node":{"fields":{"slug":"/2019/12/07/azure-kinect-library-for-node-and-electron/"},"frontmatter":{"title":"Azure Kinect Library for Node and Electron","tags":["kinect","nodejs","electron"],"cover":{"publicURL":"/static/aec9df083e4d83417f7322058b3eac1d/preview.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgUD/8QAFwEBAQEBAAAAAAAAAAAAAAAAAQIAA//aAAwDAQACEAMQAAABVpqdOWzChK5nt8qYJA//xAAdEAACAgEFAAAAAAAAAAAAAAABAwIQEgARISIz/9oACAEBAAEFAq66guJEkLxPBYcobtp3rGv/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwFjP//EABYRAQEBAAAAAAAAAAAAAAAAABAREv/aAAgBAgEBPwHJT//EABwQAAIBBQEAAAAAAAAAAAAAAAEQAgAREiEiM//aAAgBAQAGPwJxyGrXrkbXMsCK9SpP/8QAHRABAAMAAQUAAAAAAAAAAAAAAQARITEQQVGx8f/aAAgBAQABPyFZbcGm8w0ss5d4pFFM2bTxMdH0jPpwLnoQHT//2gAMAwEAAgADAAAAEMwvzf/EABkRAAMAAwAAAAAAAAAAAAAAAAABERAhMf/aAAgBAwEBPxBI4cN3j//EABgRAQADAQAAAAAAAAAAAAAAAAEAEBEh/9oACAECAQE/EBpsybOFf//EAB4QAQEAAgICAwAAAAAAAAAAAAERACExQRCRscHw/9oACAEBAAE/EBC7mOyOEIV7d4b4rGNp9Zu8Zd84UFGpZMKdlSE1xT9rASnt4oq17XlwizzPgYp2Xx//2Q=="},"images":{"fallback":{"src":"/static/aec9df083e4d83417f7322058b3eac1d/3c249/preview.jpg","srcSet":"/static/aec9df083e4d83417f7322058b3eac1d/3c249/preview.jpg 690w","sizes":"100vw"},"sources":[{"srcSet":"/static/aec9df083e4d83417f7322058b3eac1d/956b7/preview.avif 690w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/aec9df083e4d83417f7322058b3eac1d/37026/preview.webp 690w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1.3333333333333333}}}}}}]}},"pageContext":{"slug":"/2017/01/18/detecting-and-killing-processes-in-node-or-electron/","previous":{"fields":{"slug":"/2016/10/18/makey-makey-demonstration-on-ketnet/"},"frontmatter":{"title":"Makey Makey Demonstration on Ketnet","tags":["makeymakey","javascript","ketnet"]}},"next":{"fields":{"slug":"/2018/04/17/migrate-google-drive-content-to-team-drive/"},"frontmatter":{"title":"Migrate Google Drive Content to Team Drive","tags":["nodejs","google drive","team drive"]}},"tag":["nodejs","electron"]}},"staticQueryHashes":["2254173662","63159454"]}