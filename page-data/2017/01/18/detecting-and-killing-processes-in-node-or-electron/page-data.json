{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2017/01/18/detecting-and-killing-processes-in-node-or-electron/","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://blog.aboutme.be"}},"markdownRemark":{"id":"21282262-7623-5f04-aebd-c01b913b485f","excerpt":"When building a Kiosk application, you might want to check which processes are running on the system. This way you can try killing unauthorized processes or…","html":"<p>When building a Kiosk application, you might want to check which processes are running on the system. This way you can try killing unauthorized processes or show a warning when an unauthorized process is launched.</p>\n<p><a href=\"https://www.npmjs.com/package/xps\">The nodejs xps package</a> library offers a cross-platform to do most of the work. To make things a little easier, I wrote <a href=\"https://gist.github.com/wouterverweirder/a2f2253279bc2db61d2b5fe8c59b2183\">a little helper class</a> which polls the process list, allows you to specify names of unauthorized processes and dispatch events when a process launches / stops.</p>\n<p>To use this class in your own nodejs or electron apps, make sure to add <a href=\"https://www.npmjs.com/package/xps\">the nodejs xps package</a> to your app. Put <a href=\"https://gist.github.com/wouterverweirder/a2f2253279bc2db61d2b5fe8c59b2183\">my helper class</a> somewhere in your application, and use it’s api:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> processListener <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./process-listener'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> xps <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xps'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> blacklistedProcessNames <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token string\">'System Preferences'</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// do an initial check for blacklisted apps</span>\nprocessListener<span class=\"token punctuation\">.</span><span class=\"token function\">getRunningProcesses</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">processes</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// processes are the initial processes</span>\n  processes<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">process</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isProcessBlacklisted</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Blacklisted process running: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// listen for start &amp; stop of processes</span>\n  processListener<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'start'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">process</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isProcessBlacklisted</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Blacklisted process started: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      xps<span class=\"token punctuation\">.</span><span class=\"token function\">kill</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fork</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Unable to kill process </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Killed process </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  processListener<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'stop'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">process</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isProcessBlacklisted</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Blacklisted process stopped: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>pid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  processListener<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// run every x-milliseconds</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","fields":{"slug":"/2017/01/18/detecting-and-killing-processes-in-node-or-electron/"},"frontmatter":{"title":"Detecting and Killing Processes in Node or Electron","date":"18 Jan, 2017","description":false,"tags":["nodejs","electron"],"hasCover":true,"cover":{"publicURL":"/static/6121545b2c47c05d5e61016ab2b03824/preview.jpg","childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='62'%20height='62'%20viewBox='0%200%2062%2062'%20preserveAspectRatio='none'%3e%3cpath%20d='M0%2031v31h63V0H0v31m12-3H2v6l1%207h25c34%200%2032%200%2032-7%200-5%200-6-2-6H12'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e","aspectRatio":0.7493606138107417,"src":"/static/6121545b2c47c05d5e61016ab2b03824/d6678/preview.jpg","srcSet":"/static/6121545b2c47c05d5e61016ab2b03824/40917/preview.jpg 293w,\n/static/6121545b2c47c05d5e61016ab2b03824/3c0b6/preview.jpg 585w,\n/static/6121545b2c47c05d5e61016ab2b03824/d6678/preview.jpg 690w","srcWebp":"/static/6121545b2c47c05d5e61016ab2b03824/f3dc3/preview.webp","srcSetWebp":"/static/6121545b2c47c05d5e61016ab2b03824/05ceb/preview.webp 293w,\n/static/6121545b2c47c05d5e61016ab2b03824/5c538/preview.webp 585w,\n/static/6121545b2c47c05d5e61016ab2b03824/f3dc3/preview.webp 690w","sizes":"(max-width: 690px) 100vw, 690px"}}}}},"allMarkdownRemark":{"edges":[{"node":{"fields":{"slug":"/2020/12/15/building-a-laptop-driven-8-screen-installation/"},"frontmatter":{"title":"Building a laptop-driven 8-screen installation","tags":["installation","threejs","electron"],"cover":{"publicURL":"/static/e89fa65512d4b2dee79f452a43b36a99/preview.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAC/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAHWSbAUkX//xAAbEAACAgMBAAAAAAAAAAAAAAABAgAEAxESIv/aAAgBAQABBQLas61xkAsQqEK+l4E//8QAFREBAQAAAAAAAAAAAAAAAAAAABL/2gAIAQMBAT8BU//EABURAQEAAAAAAAAAAAAAAAAAAAAh/9oACAECAQE/AUf/xAAeEAABAgcBAAAAAAAAAAAAAAAAAiEBERIxMkKBof/aAAgBAQAGPwLODClVmnRiZbw//8QAGxABAAMBAAMAAAAAAAAAAAAAAQARITFRYYH/2gAIAQEAAT8h5Q+lbAAndQMmfDWdSkXhqSl+MivQ/E//2gAMAwEAAgADAAAAEFvv/8QAFxEAAwEAAAAAAAAAAAAAAAAAARARIf/aAAgBAwEBPxA4bU//xAAYEQACAwAAAAAAAAAAAAAAAAAAARExcf/aAAgBAgEBPxCnLZk//8QAHhABAAICAQUAAAAAAAAAAAAAAREhAFExQWGBkdH/2gAIAQEAAT8QZGDdHL5msGSsFVdWRWGsZpApIcNGV5DCyysd9YiuUSI9Y9LW34Z//9k=","aspectRatio":1.6901408450704225,"src":"/static/e89fa65512d4b2dee79f452a43b36a99/9da5a/preview.jpg","srcSet":"/static/e89fa65512d4b2dee79f452a43b36a99/6e6c3/preview.jpg 120w,\n/static/e89fa65512d4b2dee79f452a43b36a99/ef489/preview.jpg 240w,\n/static/e89fa65512d4b2dee79f452a43b36a99/9da5a/preview.jpg 480w,\n/static/e89fa65512d4b2dee79f452a43b36a99/9f916/preview.jpg 690w","srcWebp":"/static/e89fa65512d4b2dee79f452a43b36a99/1f47d/preview.webp","srcSetWebp":"/static/e89fa65512d4b2dee79f452a43b36a99/504a6/preview.webp 120w,\n/static/e89fa65512d4b2dee79f452a43b36a99/36764/preview.webp 240w,\n/static/e89fa65512d4b2dee79f452a43b36a99/1f47d/preview.webp 480w,\n/static/e89fa65512d4b2dee79f452a43b36a99/26a56/preview.webp 690w","sizes":"(max-width: 480px) 100vw, 480px"}}}}}},{"node":{"fields":{"slug":"/2019/12/07/azure-kinect-library-for-node-and-electron/"},"frontmatter":{"title":"Azure Kinect Library for Node and Electron","tags":["kinect","nodejs","electron"],"cover":{"publicURL":"/static/aec9df083e4d83417f7322058b3eac1d/preview.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAIBA//aAAwDAQACEAMQAAABphvHNIYZ/8QAGhAAAgIDAAAAAAAAAAAAAAAAAQIQEwMEM//aAAgBAQABBQJ2Nd2xGbqBH//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/AWf/xAAVEQEBAAAAAAAAAAAAAAAAAAAREP/aAAgBAgEBPwFJ/8QAGhAAAgIDAAAAAAAAAAAAAAAAARAAMQIjUf/aAAgBAQAGPwLUa7LCyf8A/8QAGxABAAICAwAAAAAAAAAAAAAAAQARITEQQdH/2gAIAQEAAT8hSU7wYC8yUuXcGjuoTx//2gAMAwEAAgADAAAAEATf/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAh/9oACAEDAQE/ELK//8QAFxEAAwEAAAAAAAAAAAAAAAAAARARIf/aAAgBAgEBPxC8Bf/EABkQAQADAQEAAAAAAAAAAAAAAAEAESExQf/aAAgBAQABPxAJ3xghWiPs0LZWXZap6wjmAkOLXYxsM5P/2Q==","aspectRatio":1.6901408450704225,"src":"/static/aec9df083e4d83417f7322058b3eac1d/9da5a/preview.jpg","srcSet":"/static/aec9df083e4d83417f7322058b3eac1d/6e6c3/preview.jpg 120w,\n/static/aec9df083e4d83417f7322058b3eac1d/ef489/preview.jpg 240w,\n/static/aec9df083e4d83417f7322058b3eac1d/9da5a/preview.jpg 480w,\n/static/aec9df083e4d83417f7322058b3eac1d/9f916/preview.jpg 690w","srcWebp":"/static/aec9df083e4d83417f7322058b3eac1d/1f47d/preview.webp","srcSetWebp":"/static/aec9df083e4d83417f7322058b3eac1d/504a6/preview.webp 120w,\n/static/aec9df083e4d83417f7322058b3eac1d/36764/preview.webp 240w,\n/static/aec9df083e4d83417f7322058b3eac1d/1f47d/preview.webp 480w,\n/static/aec9df083e4d83417f7322058b3eac1d/26a56/preview.webp 690w","sizes":"(max-width: 480px) 100vw, 480px"}}}}}},{"node":{"fields":{"slug":"/2018/04/17/migrate-google-drive-content-to-team-drive/"},"frontmatter":{"title":"Migrate Google Drive Content to Team Drive","tags":["nodejs","google drive","team drive"],"cover":{"publicURL":"/static/4d9b4b019195715239fc831e6282a901/preview.jpg","childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAcm0pAX/xAAZEAADAAMAAAAAAAAAAAAAAAABAhAAERL/2gAIAQEAAQUCUbxE7pn/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAEAAgMAAAAAAAAAAAAAAAABABARITH/2gAIAQEABj8CjsMFcv8A/8QAGxAAAwEAAwEAAAAAAAAAAAAAAREhABAxQXH/2gAIAQEAAT8hroCDuPCgvCC6ZB4M/m//2gAMAwEAAgADAAAAEMzP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFxEBAAMAAAAAAAAAAAAAAAAAARARIf/aAAgBAgEBPxAodj//xAAeEAABAwQDAAAAAAAAAAAAAAABABEhUWFxkRAxQf/aAAgBAQABPxApiH5Iz2RUPWPu2eIdCieFtSw0X//Z","aspectRatio":1.6901408450704225,"src":"/static/4d9b4b019195715239fc831e6282a901/9da5a/preview.jpg","srcSet":"/static/4d9b4b019195715239fc831e6282a901/6e6c3/preview.jpg 120w,\n/static/4d9b4b019195715239fc831e6282a901/ef489/preview.jpg 240w,\n/static/4d9b4b019195715239fc831e6282a901/9da5a/preview.jpg 480w,\n/static/4d9b4b019195715239fc831e6282a901/9f916/preview.jpg 690w","srcWebp":"/static/4d9b4b019195715239fc831e6282a901/1f47d/preview.webp","srcSetWebp":"/static/4d9b4b019195715239fc831e6282a901/504a6/preview.webp 120w,\n/static/4d9b4b019195715239fc831e6282a901/36764/preview.webp 240w,\n/static/4d9b4b019195715239fc831e6282a901/1f47d/preview.webp 480w,\n/static/4d9b4b019195715239fc831e6282a901/26a56/preview.webp 690w","sizes":"(max-width: 480px) 100vw, 480px"}}}}}}]}},"pageContext":{"slug":"/2017/01/18/detecting-and-killing-processes-in-node-or-electron/","previous":{"fields":{"slug":"/2016/10/18/makey-makey-demonstration-on-ketnet/"},"frontmatter":{"title":"Makey Makey Demonstration on Ketnet","tags":["makeymakey","javascript","ketnet"]}},"next":{"fields":{"slug":"/2018/04/17/migrate-google-drive-content-to-team-drive/"},"frontmatter":{"title":"Migrate Google Drive Content to Team Drive","tags":["nodejs","google drive","team drive"]}},"tag":["nodejs","electron"]}}}